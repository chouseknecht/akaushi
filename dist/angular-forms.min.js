/*
 *
 * angular-forms.js - v2.0.2 - 2014-12-01
 *
 */
"use strict";angular.module("angularforms",[]).factory("AngularForms",["$compile",function(a){return function(b){var c,d;return c=function(a){return null===a||void 0===a||""===a?!0:!1},new(d=function(){this.defaultCss={help:"help-text",error:"error"},this.init=function(){var a;if(this.form=b.form,this.targetId=b.targetId,this.scope=b.scope,c(b.formCss))this.formCss=this.defaultCss;else{this.formCss=b.formCss;for(a in this.defaultCss)c(this.formCss[a])&&(this.formCss[a]=this.defaultCss[a])}this.col_size="col-sm-10"},this.build=function(){var a,b,c,d,e,f,g=this.startForm();this.form.horizontal&&this.form.inputColSize&&(this.col_size=parseInt(this.form.inputColSize,10));for(b in this.form.fields){switch(c=this.form.fields[b],d="",e="",c.type){case"text":case"password":case"email":case"number":case"spinner":d+=this.inputField(b,c);break;case"select":d+=this.select(b,c);break;case"checkbox":case"radio":d+=this.indicator(b,c);break;case"checkbox_group":d+=this.checkboxGroup(b,c);break;case"radio_group":d+=this.radioGroup(b,c);break;case"textarea":d+=this.textArea(b,c);break;case"custom":d+=this.customField(b,c)}if(c.helpText&&(d+='<div class="',d+=this.formCss.help,d+='">'+c.helpText+"</div>"),d+=this.addValidations(b,c),"checkbox"!==c.type&&"radio"!==c.type&&c.label&&(e=this.fieldLabel(b,c)),this.form.horizontal)g+='<div class="form-group',g+=c.groupClass?" "+c.groupClass:"",g+='"',g+=c.ngHide?this.attribute(c,"ngHide"):"",g+=c.ngShow?this.attribute(c,"ngShow"):"",g+=">\n",g+=e,"checkbox"===c.type?(f="col-sm-offset-"+(12-this.col_size),g+='<div class="'+f+" "+this.col_size+'">\n',g+='<div class="checkbox">\n'):"radio"===c.type?(f="col-sm-offset-"+(12-this.col_size),g+='<div class="'+f+" "+this.col_size+'">\n',g+='<div class="radio">\n'):g+='<div class="col-sm-'+this.col_size+'">\n',g+=d,g+="checkbox"===c.type||"radio"===c.type?"</div><!-- checkbox/radio -->\n":"",g+="</div>\n",g+="</div><!-- form-group -->\n";else{switch(g+='<div class="',c.type){case"checkbox":g+="checkbox";break;case"radio":g+="radio";break;default:g+="form-group"}g+=c.groupClass?" "+c.groupClass:"",g+='"',g+=c.ngHide?this.attribute(c,"ngHide"):"",g+=c.ngShow?this.attribute(c,"ngShow"):"",g+=">\n",g+=e,g+=d,g+=this.form.horizontal?"</div>\n":"",g+="</div><!-- form-group -->\n"}}if(this.form.buttons){g+='<div class="form-group buttons">\n',this.form.horizontal&&(f="col-sm-offset-"+(12-this.col_size),g+='<div class="'+f+" "+this.col_size+'">\n');for(a in this.form.buttons)g+=this.button(a,this.form.buttons[a]);g+=this.form.horizontal?"</div>\n":"",g+="</div>\n"}return g+="</form>\n"},this.placeholderStar=function(a){return this.form.starRequired&&a.required?a.label&&!a.srOnly?"":"* ":""},this.inputField=function(a,b){var c,d="";d+="spinner"===b.type?"<div>\n":"",d+="<input ",d+="spinner"!==b.type?'type="'+b.type+'" ':"",d+="spinner"===b.type?'af-spinner="'+this.form.name+'" ':"",d+='ng-model="',d+=this.form.modelObject?b.ngModel?this.form.modelObject+"."+b.ngModel:this.form.modelObject+"."+a:b.ngModel?b.ngModel:a,d+='" name="'+a+'" id="fld_'+a+'" ',d+=this.addInputClass(b),d+=b.ngShow?this.attribute(b,"afOnShow"):"",d+=b.ngHide?this.attribute(b,"afOnHide"):"",b.placeholder&&(d+=' placeholder="',d+=this.placeholderStar(b),d+=b.placeholder+'"');for(c in b)"label"!==c&&"type"!==c&&"srOnly"!==c&&"class"!==c&&"ngHide"!==c&&"ngShow"!==c&&"placeholder"!==c&&(d+=this.attribute(b,c));return d+=">",d+="spinner"===b.type?"</div>\n":""},this.textArea=function(a,b){var c,d="";d+='<textarea ng-model="',d+=this.form.modelObject?b.ngModel?this.form.modelObject+"."+b.ngModel:this.form.modelObject+"."+a:b.ngModel?b.ngModel:a,d+='" name="'+a+'" id="fld_'+a+'" ',d+=this.addInputClass(b),d+=b.rows?"":'rows="5" ',d+=b.ngShow?this.attribute(b,"afOnShow"):"",d+=b.ngHide?this.attribute(b,"afOnHide"):"";for(c in b)"label"!==c&&"type"!==c&&"srOnly"!==c&&"class"!==c&&"ngHide"!==c&&"ngShow"!==c&&(d+=this.attribute(b,c));return d+="></textarea>"},this.customField=function(a,b){return b.html},this.select=function(a,b){var c,d="";d+='<select ng-model="',d+=this.form.modelObject?b.ngModel?this.form.modelObject+"."+b.ngModel:this.form.modelObject+"."+a:b.ngModel?b.ngModel:a,d+='"',d+='" name="'+a+'" id="fld_'+a+'" ',d+=this.addInputClass(b),b.optionArray&&("object"==typeof b.optionArray?(this.scope[this.form.name+"_"+a+"_options"]=b.optionArray,d+='ng-options="itm.id as itm.label for itm in '+this.form.name+"_"+a+'_options" '):d+='ng-options="itm.id as itm.label for itm in '+b.optionArray+'" ');for(c in b)"label"!==c&&"type"!==c&&"srOnly"!==c&&"class"!==c&&"optionArray"!==c&&"placeholder"!==c&&"ngHide"!==c&&"ngShow"!==c&&(d+=this.attribute(b,c));return d+=b.ngShow?this.attribute(b,"afOnShow"):"",d+=b.ngHide?this.attribute(b,"afOnHide"):"",d+=">",d+=b.placeholder?'\n<option value="">'+b.placeholder+"</option>\n":"",d+="</select>\n"},this.indicator=function(a,b){var c,d="";d+='<input type="'+b.type+'" ng-model="',d+=this.form.modelObject?b.ngModel?this.form.modelObject+"."+b.ngModel:this.form.modelObject+"."+a:b.ngModel?b.ngModel:a,d+='" name="'+a+'" id="fld_'+a+'" ',d+=b["class"]?'class="'+b["class"]+'" ':"";for(c in b)"label"!==c&&"type"!==c&&"srOnly"!==c&&"class"!==c&&"ngHide"!==c&&"ngShow"!==c&&(d+=this.attribute(b,c));return d+=">",("checkbox"===b.type||"radio"===b.type)&&(d=this.labelWrap(a,b,d)),d},this.checkboxGroup=function(a,b){var c,d="";for(d+='<div class="checkbox-group">\n',c=0;c<b.checkboxes.length;c++)b.checkboxes[c].type="checkbox",b.checkboxes[c].labelClass="checkbox-inline",d+=this.indicator(b.checkboxes[c].model,b.checkboxes[c]);return d+="</div><!-- checkbox-group -->\n"},this.radioGroup=function(a,b){var c,d="";for(d+='<div class="radio-group">\n',c=0;c<b.options.length;c++)b.options[c].type="radio",b.options[c].labelClass="radio-inline",d+=this.indicator(a,b.options[c]);return d+="</div><!-- radio-group -->\n"},this.labelWrap=function(a,b,c){var d="";return d+="<label ",b.labelClass&&(d+='class="'+b.labelClass+'" '),d+=b.ngShow?this.attribute(b,"ngShow"):"",d+=b.ngHide?this.attribute(b,"ngHide"):"",d+=">"+c+" "+b.label+"</label>\n"},this.addValidations=function(a,b){var c,d='<div class="field-error-group">\n';return(b.required||b.ngRequired)&&(d+='<div class="',d+=this.formCss.error,d+='" ng-show="!'+this.form.name+"."+a+".$pristine && "+this.form.name+"."+a+'.$error.required">A value is required.</div>\n'),"email"===b.type&&(d+='<div class="',d+=this.formCss.error,d+='" ng-show="!'+this.form.name+"."+a+".$pristine && "+this.form.name+"."+a+'.$error.email">Please provide a valid email address.</div>\n'),"number"===b.type&&(d+='<div class="',d+=this.formCss.error,d+='" ng-show="'+this.form.name+"."+a+'.$error.number">Please provide a numeric value.</div>\n'),b.ngMinlength&&(d+='<div class="',d+=this.formCss.error,d+='" ng-show="!'+this.form.name+"."+a+".$pristine && "+this.form.name+"."+a+'.$error.minlength">Must contain a minimum of '+b.ngMinlength+" characters.</div>\n"),b.ngMaxlength&&(d+='<div class="',d+=this.formCss.error,d+='" ng-show="!'+this.form.name+"."+a+".$pristine && "+this.form.name+"."+a+'.$error.maxlength">Length must be less than '+b.ngMaxlength+" characters.</div>\n"),b.ngPattern&&(c=b.patternErrorMsg?b.patternErrorMsg:"Please provide a valid value",d+='<div class="',d+=this.formCss.error,d+='" ng-show="!'+this.form.name+"."+a+".$pristine && "+this.form.name+"."+a+'.$error.pattern">'+c+"</div>\n"),d+='<div class="',d+=this.formCss.error,d+='" ng-show="!'+this.form.name+"."+a+".$pristine && "+this.form.name+"_"+a+'_error" ng-bind="'+this.form.name+"_"+a+'_error"></div>\n',d+="</div>"},this.fieldLabel=function(a,b){var c,d="";return this.form.horizontal&&(c="col-sm-"+(12-this.col_size)),d+='<label for="'+a+'"',(b.srOnly||b.labelClass||this.form.horizontal)&&(d+=' class="',d+=this.form.horizontal?c+" control-label ":"",d+=b.srOnly?"sr-only ":"",d+=b.labelClass?b.labelClass:"",d+='"'),d+=">",this.form.starRequired&&b.required&&!b.srOnly&&(d+="* "),d+=b.label+"</label>\n"},this.startForm=function(){var a="";return a+="<form",a+=' name="'+this.form.name+'"',(this.form.horizontal||this.form["class"])&&(a+=' class="',a+=this.form.horizontal?"form-horizontal":"",a+=this.form["class"]?" "+this.form["class"]:"",a+='"'),a+=' role="form"',a+=" novalidate >\n"},this.addInputClass=function(a){var b="";return b+='class="',b+="spinner"!==a.type?"form-control":"",b+=a["class"]?" "+a["class"]:"",b+='"'},this.attribute=function(a,b){var c,d="";if(b.match(/^ng/))c=b.replace(/^ng/,"").toLowerCase(),d+=" ng-"+c+'="'+a[b]+'"';else if("afOnHide"===b)d+=' af-on-hide="'+a.ngHide+'"';else if("afOnShow"===b)d+=' af-on-show="'+a.ngShow+'"';else if("helpText"!==b&&"labelClass"!==b&&"defaultValue"!==b)switch(b){case"required":d+=" required";break;case"autocomplete":d+=' autocomplete="',d+=a.autocomplete===!0||"on"===a.autocomplete?'on"':'off"';break;default:d+=a[b]?" "+b+'="'+a[b]+'" ':" "+b+" "}return d},this.button=function(a,b){var c,d='<button type="button" class="btn';d+=b["class"]?" "+b["class"]:" btn-default",d+='"';for(c in b)"class"!==c&&"icon"!==c&&"label"!==c&&(d+=this.attribute(b,c));return b.ngDisabled||"save"!==a||(d+=' ng-disabled="'+this.form.name+".$invalid || "+this.form.name+'.$pristine"'),b.ngDisabled||"reset"!==a||(d+=' ng-disabled="'+this.form.name+'.$pristine"'),d+=">",d+=b.icon?'<i class="fa '+b.icon+'"></i> ':"",d+=b.label?b.label:"",d+="</button>\n"},this.inject=function(){var b=angular.element(document.getElementById(this.targetId));b.append(this.build()),a(b)(this.scope)},this.getHtml=function(){return this.build()},this.setError=function(a,b){this.scope[this.form.name+"_"+a+"_error"]=b,this.scope[this.form.name][a]&&(this.scope[this.form.name][a].$pristine=!1,this.scope[this.form.name][a].$dirty=!0),$("#fld_"+a).removeClass("ng-pristine").removeClass("ng-valid").removeClass("ng-valid-custom-error").addClass("ng-dirty").addClass("ng-invalid").addClass("ng-invalid-custom-error")},this.clearError=function(a){this.scope[this.form.name+"_"+a+"_error"]=null,$("#fld_"+a).addClass("ng-valid").addClass("ng-valid-custom-error").removeClass("ng-invalid").removeClass("ng-invalid-custom-error")},this.clearErrors=function(){for(var a in this.form.fields)this.scope[this.form.name+"_"+a+"_error"]="",this.scope[this.form.name][a]&&(this.scope[this.form.name][a].$setValidity("custom-error",!0),this.scope[this.form.name][a].$setPristine())},this.resetForm=function(a){var b,d,e,f,g;e=c(a)?{}:a;for(b in this.form.fields)d=this.form.fields[b],f=d.ngModel?d.ngModel:b,"spinner"===d.type?(g=c(e[f])?c(d.defaultValue)?"":d.defaultValue:e[f],$("#fld_"+b).spinner("value",g)):e[f]?this.form.modelObject?this.scope[this.form.modelObject][f]=e[f]:this.scope[f]=e[f]:c(d.defaultValue)?this.form.modelObject?this.scope[this.form.modelObject][f]="":this.scope[f]="":this.form.modelObject?this.scope[this.form.modelObject][f]=d.defaultValue:this.scope[f]=d.defaultValue,this.scope[this.form.name][b]&&(this.scope[this.form.name][b].$setPristine(),this.scope[this.form.name][b].$setValidity("custom-error",!0)),this.scope[this.form.name+"_"+b+"_error"]=""},this.init()})}}]).directive("afSpinner",[function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.afSpinner;$(b).spinner({change:function(){a[c.ngModel]=$(this).spinner("value")},spin:function(){a[e].$setDirty(),d.$dirty=!0,d.$pristine=!1,a.$$phase||a.$digest()}}),$(b).on("click",function(){$(this).select()})}}}]).directive("afOnShow",function(){return{require:"^form",restrict:"A",link:function(a,b,c,d){var e;a.$watch(c.afOnShow,function(a){e||(e=d[b.attr("name")]),a===!0?(d.$addControl(e),angular.forEach(e.$error,function(a,b){d.$setValidity(b,!a,e)})):d.$removeControl(e)})}}}).directive("afOnHide",function(){return{require:"^form",restrict:"A",link:function(a,b,c,d){var e;a.$watch(c.afOnHide,function(a){e||(e=d[b.attr("name")]),a?d.$removeControl(e):(d.$addControl(e),angular.forEach(e.$error,function(a,b){d.$setValidity(b,!a,e)}))})}}});